import{s as k}from"./vue-multiselect.min-0uMGTNXd.js";import{d as N,u as T,f as d,g as V,_ as U,c as w,a as o,w as a,v as r,h as F,b as v,i as E,o as y}from"./index-u6tEbDFJ.js";const S=N({components:{Multiselect:k},setup(){const s=T(),e=d(null),b=d([]),n=d({first_name:"",last_name:"",email:"",date_of_birth:"",selectedHobbies:[]}),u=d({name:"",description:""}),m=d(!1),f=d({old_password:"",new_password:"",new_password_confirm:""}),l=d(!1),P=async()=>{try{const i=await(await fetch("http://localhost:8000/api/my_profile",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token "+s.token}})).json();e.value=i.result,e.value&&(n.value={first_name:e.value.first_name,last_name:e.value.last_name,email:e.value.email,date_of_birth:e.value.date_of_birth,selectedHobbies:e.value.hobbies.map(p=>p)}),h()}catch(t){console.error("Error loading profile:",t)}},h=async()=>{try{const i=await(await fetch("http://localhost:8000/api/hobbies/",{method:"GET",headers:{"Content-Type":"application/json"}})).json();b.value=i.result}catch(t){console.error("Error loading hobbies list:",t)}},g=async()=>{try{const i=n.value.selectedHobbies.filter(p=>p&&p.id!=="add_new").map(p=>p.id);await fetch("http://localhost:8000/api/profile/update/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Token "+s.token},body:JSON.stringify({first_name:n.value.first_name,last_name:n.value.last_name,email:n.value.email,date_of_birth:n.value.date_of_birth,hobbies:i})}),alert("Profile updated successfully!"),P()}catch(t){console.error("Error updating profile:",t)}},H=t=>{u.value.name=t,m.value=!0},C=async()=>{try{const i=await(await fetch("http://localhost:8000/api/hobbies/add/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Token "+s.token},body:JSON.stringify(u.value)})).json();b.value.push(i.result),n.value.selectedHobbies.push(i.result),u.value={name:"",description:""},m.value=!1}catch(t){console.error("Failed to add new hobby:",t)}},c=async()=>{try{(await fetch("http://localhost:8000/api/profile/change_password/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token "+s.token},body:JSON.stringify(f.value)})).status===200?(alert("Password changed successfully!"),l.value=!1):alert("Failed to change password. Please try again.")}catch(t){console.error("Error changing password:",t)}};return V(()=>{P()}),{userProfile:e,hobbiesList:b,editProfile:n,newHobby:u,showNewHobbyForm:m,passwordForm:f,showChangePassword:l,updateProfile:g,addNewHobbyOption:H,addNewHobby:C,changePassword:c}}}),j={class:"container mt-5"},O={class:"profile-section mb-4"},$={key:0},A=["src"],D={key:0,class:"mt-3"},M={class:"change-password-section"},z={key:0,class:"modal-overlay"},B={class:"modal-content"};function L(s,e,b,n,u,m){const f=E("Multiselect");return y(),w("div",j,[e[28]||(e[28]=o("h1",null,"User Dashboard",-1)),o("div",O,[e[22]||(e[22]=o("h3",null,"Your Profile",-1)),s.userProfile?(y(),w("div",$,[o("img",{src:s.userProfile.profile_image,alt:"Profile Picture",class:"profile-image mb-3"},null,8,A),o("div",null,[e[15]||(e[15]=o("label",null,"First Name:",-1)),a(o("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>s.editProfile.first_name=l),class:"form-control mb-2"},null,512),[[r,s.editProfile.first_name]])]),o("div",null,[e[16]||(e[16]=o("label",null,"Last Name:",-1)),a(o("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=l=>s.editProfile.last_name=l),class:"form-control mb-2"},null,512),[[r,s.editProfile.last_name]])]),o("div",null,[e[17]||(e[17]=o("label",null,"Email:",-1)),a(o("input",{type:"email","onUpdate:modelValue":e[2]||(e[2]=l=>s.editProfile.email=l),class:"form-control mb-2"},null,512),[[r,s.editProfile.email]])]),o("div",null,[e[18]||(e[18]=o("label",null,"Date of Birth:",-1)),a(o("input",{type:"date","onUpdate:modelValue":e[3]||(e[3]=l=>s.editProfile.date_of_birth=l),class:"form-control mb-2"},null,512),[[r,s.editProfile.date_of_birth]])]),o("div",null,[e[21]||(e[21]=o("label",null,"Hobbies:",-1)),F(f,{modelValue:s.editProfile.selectedHobbies,"onUpdate:modelValue":e[4]||(e[4]=l=>s.editProfile.selectedHobbies=l),options:s.hobbiesList,multiple:!0,searchable:!0,taggable:!0,label:"name","track-by":"id",placeholder:"Select or add hobbies",onTag:s.addNewHobbyOption},null,8,["modelValue","options","onTag"]),s.showNewHobbyForm?(y(),w("div",D,[e[19]||(e[19]=o("label",null,"New Hobby Name:",-1)),a(o("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=l=>s.newHobby.name=l),placeholder:"Enter hobby name",class:"form-control mb-2"},null,512),[[r,s.newHobby.name]]),e[20]||(e[20]=o("label",null,"Description:",-1)),a(o("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>s.newHobby.description=l),placeholder:"Enter hobby description",class:"form-control mb-2"},null,512),[[r,s.newHobby.description]]),o("button",{class:"btn btn-primary",onClick:e[7]||(e[7]=(...l)=>s.addNewHobby&&s.addNewHobby(...l))},"Add Hobby")])):v("",!0)]),o("button",{class:"btn btn-primary",onClick:e[8]||(e[8]=(...l)=>s.updateProfile&&s.updateProfile(...l))},"Save Profile")])):v("",!0)]),o("div",M,[e[23]||(e[23]=o("h3",null,"Change Password",-1)),o("button",{class:"btn btn-warning",onClick:e[9]||(e[9]=l=>s.showChangePassword=!0)},"Change Password")]),s.showChangePassword?(y(),w("div",z,[o("div",B,[e[27]||(e[27]=o("h3",null,"Change Password",-1)),o("div",null,[e[24]||(e[24]=o("label",null,"Old Password:",-1)),a(o("input",{type:"password","onUpdate:modelValue":e[10]||(e[10]=l=>s.passwordForm.old_password=l),class:"form-control mb-2"},null,512),[[r,s.passwordForm.old_password]])]),o("div",null,[e[25]||(e[25]=o("label",null,"New Password:",-1)),a(o("input",{type:"password","onUpdate:modelValue":e[11]||(e[11]=l=>s.passwordForm.new_password=l),class:"form-control mb-2"},null,512),[[r,s.passwordForm.new_password]])]),o("div",null,[e[26]||(e[26]=o("label",null,"Confirm New Password:",-1)),a(o("input",{type:"password","onUpdate:modelValue":e[12]||(e[12]=l=>s.passwordForm.new_password_confirm=l),class:"form-control mb-2"},null,512),[[r,s.passwordForm.new_password_confirm]])]),o("button",{class:"btn btn-primary",onClick:e[13]||(e[13]=(...l)=>s.changePassword&&s.changePassword(...l))},"Submit"),o("button",{class:"btn btn-secondary",onClick:e[14]||(e[14]=l=>s.showChangePassword=!1)},"Close")])])):v("",!0)])}const I=U(S,[["render",L],["__scopeId","data-v-061197e2"]]);export{I as default};
