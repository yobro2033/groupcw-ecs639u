import{i as A,j as g,q as E,_ as j,l as c,m as t,f as k,n as y,t as u,e as T,F as U,g as M,o as d,a as V,w as D,p as I}from"./index-hqP6vyLU.js";function f(){const e=document.cookie.split(";");for(const n of e){const[p,m]=n.split("=");if(p.trim()==="csrftoken")return m}return null}function N(e,n){let p;return(...m)=>{clearTimeout(p),p=window.setTimeout(()=>e.apply(null,m),n)}}const X=A({setup(){const e=g(""),n=g(12),p=g(60),m=g([]),w=12,C=100,o=g(null),s=g(null),a=g(1),h=g(1),i=async()=>{if(o.value=null,s.value=null,e.value!==""||e.value==="")try{const r=await(await fetch(`/api/users/?search=${e.value}&l_age=${n.value}&u_age=${p.value}&page=${a.value}`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();r.success==="true"?(m.value=r.result.users||[],a.value=r.result.current_page,h.value=r.result.total_pages):o.value=r.error}catch(l){console.error("Error searching users:",l),o.value="An error occurred while searching users."}},q=N(i,100),F=async l=>{o.value=null,s.value=null;try{const r=f(),v=await(await fetch(`/api/friend_request/send/${l}/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":r||""}})).json();v.success==="true"?(s.value="Friend request sent!",i()):o.value=v.error}catch(r){console.error("Error sending friend request:",r),o.value="An error occurred while sending friend request."}},P=async l=>{o.value=null,s.value=null;try{const r=f();(await await fetch(`/api/sent_request/remove/${l}/`,{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRFToken":r||""}})).status===204?(s.value="Friend request canceled!",i()):o.value="An error occurred while canceling friend request."}catch(r){console.error("Error canceling friend request:",r),o.value="An error occurred while canceling friend request."}},_=async l=>{o.value=null,s.value=null;try{const r=f(),v=await(await fetch(`/api/friend_request/accept/${l}/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":r||""}})).json();v.success==="true"?(s.value="Friend request accepted!",i()):o.value=v.error}catch(r){console.error("Error accepting friend request:",r),o.value="An error occurred while accepting friend request."}},S=async l=>{o.value=null,s.value=null;try{const r=f();(await await fetch(`/api/friend/remove/${l}/`,{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRFToken":r||""}})).status===204?(s.value="Friend removed!",i()):o.value="An error occurred while removing friend."}catch(r){console.error("Error removing friend:",r),o.value="An error occurred while removing friend."}},$=()=>{a.value<h.value&&(a.value++,i())},R=()=>{a.value>1&&(a.value--,i())};return E([e,a],i,{immediate:!0}),{searchTerm:e,l_age:n,u_age:p,users:m,minAge:w,maxAge:C,errorMessage:o,successMessage:s,currentPage:a,totalPages:h,searchUsers:i,debouncedSearchUsers:q,sendFriendRequest:F,cancelFriendRequest:P,acceptFriendRequest:_,removeFriend:S,nextPage:$,prevPage:R}}}),B={class:"container mt-5"},L={class:"search-section mb-4 p-4 shadow-sm rounded bg-white"},O={class:"search-bar mb-3"},G={class:"age-slider"},z=["min","max"],H=["min","max"],J={key:0,class:"alert alert-danger"},K={key:1,class:"alert alert-success"},Q={class:"user-list list-group"},W={class:"user-info"},Y=["src"],Z=["onClick"],x=["onClick"],ee=["onClick"],se=["onClick"],ne={class:"pagination-section mt-4 p-4 shadow-sm rounded bg-white d-flex justify-content-between align-items-center"},re=["disabled"],te=["disabled"];function oe(e,n,p,m,w,C){const o=I("router-link");return d(),c("div",B,[n[8]||(n[8]=t("h1",{class:"text-center mb-4"},"Search Page",-1)),t("div",L,[t("div",O,[k(t("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=s=>e.searchTerm=s),onInput:n[1]||(n[1]=(...s)=>e.searchUsers&&e.searchUsers(...s)),placeholder:"Search for a user",class:"form-control mb-3"},null,544),[[y,e.searchTerm]]),t("div",G,[t("label",null,"Age Range: "+u(e.l_age)+" - "+u(e.u_age),1),k(t("input",{type:"range","onUpdate:modelValue":n[2]||(n[2]=s=>e.l_age=s),min:e.minAge,max:e.u_age,onInput:n[3]||(n[3]=(...s)=>e.debouncedSearchUsers&&e.debouncedSearchUsers(...s)),class:"form-range"},null,40,z),[[y,e.l_age]]),k(t("input",{type:"range","onUpdate:modelValue":n[4]||(n[4]=s=>e.u_age=s),min:e.l_age,max:e.maxAge,onInput:n[5]||(n[5]=(...s)=>e.debouncedSearchUsers&&e.debouncedSearchUsers(...s)),class:"form-range"},null,40,H),[[y,e.u_age]])])]),e.errorMessage?(d(),c("div",J,u(e.errorMessage),1)):T("",!0),e.successMessage?(d(),c("div",K,u(e.successMessage),1)):T("",!0),t("ul",Q,[(d(!0),c(U,null,M(e.users,s=>(d(),c("li",{key:s.id,class:"list-group-item d-flex justify-content-between align-items-center"},[t("div",W,[V(o,{to:"/profile/"+s.id,class:"profile-link"},{default:D(()=>[t("img",{src:s.profile_image,alt:"Profile",class:"profile-image"},null,8,Y),t("span",null,u(s.first_name)+" "+u(s.last_name),1)]),_:2},1032,["to"]),t("p",null,"Common hobbies: "+u(s.common_hobby_count),1)]),t("div",null,[s.isFriend?(d(),c("button",{key:0,class:"btn btn-danger",onClick:a=>e.removeFriend(s.id)}," Remove Friend ",8,Z)):s.hasSentRequest?(d(),c("button",{key:1,class:"btn btn-warning",onClick:a=>e.cancelFriendRequest(s.id)}," Cancel Request ",8,x)):s.hasPendingRequest?(d(),c("button",{key:2,class:"btn btn-success",onClick:a=>e.acceptFriendRequest(s.id)}," Accept ",8,ee)):(d(),c("button",{key:3,class:"btn btn-primary",onClick:a=>e.sendFriendRequest(s.id)}," Add Friend ",8,se))])]))),128))])]),t("div",ne,[t("div",null,[t("button",{onClick:n[6]||(n[6]=(...s)=>e.prevPage&&e.prevPage(...s)),disabled:e.currentPage===1,class:"btn btn-primary"}," Previous ",8,re),t("button",{onClick:n[7]||(n[7]=(...s)=>e.nextPage&&e.nextPage(...s)),disabled:e.currentPage===e.totalPages,class:"btn btn-primary"}," Next ",8,te)]),t("span",null,"Page "+u(e.currentPage)+" of "+u(e.totalPages),1)])])}const le=j(X,[["render",oe],["__scopeId","data-v-f353f815"]]);export{le as default};
