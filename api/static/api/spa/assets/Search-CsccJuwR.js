import{d as F,u as $,r as m,s as E,_ as R,c as i,b as t,w as k,v as y,t as c,e as C,F as S,p as U,o as l,h as j,l as M,i as V}from"./index-BumwQ-_g.js";function q(){const s=document.cookie.split(";");for(const n of s){const[u,d]=n.split("=");if(u.trim()==="csrftoken")return d}return null}const z=F({setup(){const s=$(),n=m(""),u=m(12),d=m(60),v=m([]),T=12,f=100,e=m(null),o=m(null),p=async()=>{if(e.value=null,o.value=null,n.value!=="")try{const r=await(await fetch(`/api/users/?search=${n.value}&l_age=${u.value}&u_age=${d.value}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token "+s.token}})).json();r.success==="true"?v.value=r.result.users||[]:e.value=r.error}catch(a){console.error("Error searching users:",a),e.value="An error occurred while searching users."}},w=async a=>{e.value=null,o.value=null;try{const r=q(),h=await(await fetch(`/api/friend_request/send/${a}/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token "+s.token,"X-CSRFToken":r||""}})).json();h.success==="true"?(o.value="Friend request sent!",p()):e.value=h.error}catch(r){console.error("Error sending friend request:",r),e.value="An error occurred while sending friend request."}},_=async a=>{e.value=null,o.value=null;try{(await await fetch(`/api/sent_request/remove/${a}/`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Token "+s.token}})).status===204?(o.value="Friend request canceled!",p()):e.value="An error occurred while canceling friend request."}catch(r){console.error("Error canceling friend request:",r),e.value="An error occurred while canceling friend request."}},b=async a=>{e.value=null,o.value=null;try{const r=q(),h=await(await fetch(`/api/friend_request/accept/${a}/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token "+s.token,"X-CSRFToken":r||""}})).json();h.success==="true"?(o.value="Friend request accepted!",p()):e.value=h.error}catch(r){console.error("Error accepting friend request:",r),e.value="An error occurred while accepting friend request."}},A=async a=>{e.value=null,o.value=null;try{(await await fetch(`/api/friend/remove/${a}/`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Token "+s.token}})).status===204?(o.value="Friend removed!",p()):e.value="An error occurred while removing friend."}catch(r){console.error("Error removing friend:",r),e.value="An error occurred while removing friend."}};return E([n,u,d],p,{immediate:!0}),{searchTerm:n,l_age:u,u_age:d,users:v,minAge:T,maxAge:f,errorMessage:e,successMessage:o,searchUsers:p,sendFriendRequest:w,cancelFriendRequest:_,acceptFriendRequest:b,removeFriend:A}}}),P={class:"container mt-5"},D={class:"search-bar"},I={class:"age-slider"},B=["min","max"],L=["min","max"],N={key:0,class:"alert alert-danger"},O={key:1,class:"alert alert-success"},X={class:"user-list"},G={class:"user-info"},H=["src"],J=["onClick"],K=["onClick"],Q=["onClick"],W=["onClick"];function Y(s,n,u,d,v,T){const f=V("router-link");return l(),i("div",P,[n[6]||(n[6]=t("h1",null,"Search Page",-1)),t("div",D,[k(t("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=e=>s.searchTerm=e),onInput:n[1]||(n[1]=(...e)=>s.searchUsers&&s.searchUsers(...e)),placeholder:"Search for a user",class:"form-control mb-3"},null,544),[[y,s.searchTerm]]),t("div",I,[t("label",null,"Age Range: "+c(s.l_age)+" - "+c(s.u_age),1),k(t("input",{type:"range","onUpdate:modelValue":n[2]||(n[2]=e=>s.l_age=e),min:s.minAge,max:s.u_age,onInput:n[3]||(n[3]=(...e)=>s.searchUsers&&s.searchUsers(...e))},null,40,B),[[y,s.l_age]]),k(t("input",{type:"range","onUpdate:modelValue":n[4]||(n[4]=e=>s.u_age=e),min:s.l_age,max:s.maxAge,onInput:n[5]||(n[5]=(...e)=>s.searchUsers&&s.searchUsers(...e))},null,40,L),[[y,s.u_age]])])]),s.errorMessage?(l(),i("div",N,c(s.errorMessage),1)):C("",!0),s.successMessage?(l(),i("div",O,c(s.successMessage),1)):C("",!0),t("ul",X,[(l(!0),i(S,null,U(s.users,e=>(l(),i("li",{key:e.id,class:"user-item"},[t("div",G,[j(f,{to:"/profile/"+e.id,class:"profile-link"},{default:M(()=>[t("img",{src:e.profile_image,alt:"Profile",class:"profile-image"},null,8,H),t("span",null,c(e.first_name)+" "+c(e.last_name),1)]),_:2},1032,["to"]),t("p",null,"Common hobbies: "+c(e.common_hobby_count),1)]),t("div",null,[e.isFriend?(l(),i("button",{key:0,class:"btn btn-danger",onClick:o=>s.removeFriend(e.id)}," Remove Friend ",8,J)):e.hasSentRequest?(l(),i("button",{key:1,class:"btn btn-warning",onClick:o=>s.cancelFriendRequest(e.id)}," Cancel Request ",8,K)):e.hasPendingRequest?(l(),i("button",{key:2,class:"btn btn-success",onClick:o=>s.acceptFriendRequest(e.id)}," Accept ",8,Q)):(l(),i("button",{key:3,class:"btn btn-primary",onClick:o=>s.sendFriendRequest(e.id)}," Add Friend ",8,W))])]))),128))])])}const x=R(z,[["render",Y],["__scopeId","data-v-40f81dc4"]]);export{x as default};
