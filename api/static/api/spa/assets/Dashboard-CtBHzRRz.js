import{s as j}from"./vue-multiselect.min-CeohBFr8.js";import{d as A,u as O,r as d,g as D,_ as $,c as f,b as s,w as u,v as p,h as z,e as y,t as k,i as B,o as w}from"./index-BumwQ-_g.js";function C(){const o=document.cookie.split(";");for(const e of o){const[v,a]=e.split("=");if(v.trim()==="csrftoken")return a}return null}const L=A({components:{Multiselect:j},setup(){const o=O(),e=d(null),v=d([]),a=d({first_name:"",last_name:"",email:"",date_of_birth:"",selectedHobbies:[]}),g=d({name:"",description:""}),P=d(!1),b=d({old_password:"",new_password:"",new_password_confirm:""}),l=d(!1),n=d(null),c=d(null),m=d(null),H=async()=>{try{const t=await(await fetch("/api/my_profile",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token "+o.token}})).json();t.success==="true"?(e.value=t.result,e.value&&(a.value={first_name:e.value.first_name,last_name:e.value.last_name,email:e.value.email,date_of_birth:e.value.date_of_birth,selectedHobbies:e.value.hobbies.map(i=>i)})):n.value=t.error}catch(r){console.error("Error loading profile:",r),n.value="An error occurred while loading profile."}},M=async()=>{try{const t=await(await fetch("/api/hobbies/",{method:"GET",headers:{"Content-Type":"application/json"}})).json();t.success==="true"?v.value=t.result:n.value=t.error}catch(r){console.error("Error loading hobbies list:",r),n.value="An error occurred while loading hobbies list."}},U=async()=>{n.value=null,m.value=null;try{const t=a.value.selectedHobbies.filter(h=>h&&h.id!=="add_new").map(h=>h.id),i=C(),N=await(await fetch("/api/profile/update/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Token "+o.token,"X-CSRFToken":i||""},body:JSON.stringify({first_name:a.value.first_name,last_name:a.value.last_name,email:a.value.email,date_of_birth:a.value.date_of_birth,hobbies:t})})).json();N.success==="true"?(m.value="Profile updated successfully!",H()):n.value=N.error}catch(r){console.error("Error updating profile:",r),n.value="An error occurred while updating profile."}},V=r=>{g.value.name=r,P.value=!0},F=async()=>{n.value=null,m.value=null;try{const r=C(),i=await(await fetch("/api/hobbies/add/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Token "+o.token,"X-CSRFToken":r||""},body:JSON.stringify(g.value)})).json();i.success==="true"?(v.value.push(i.result),a.value.selectedHobbies.push(i.result),g.value={name:"",description:""},P.value=!1,m.value="New hobby added successfully!"):n.value=i.error}catch(r){console.error("Failed to add new hobby:",r),n.value="An error occurred while adding new hobby."}},E=()=>{l.value=!0},T=()=>{l.value=!1},S=async()=>{c.value=null,m.value=null;try{if(b.value.new_password!==b.value.new_password_confirm){c.value="New passwords do not match.";return}if(b.value.new_password.length<8){c.value="New password must be at least 8 characters long.";return}const r=C(),i=await(await fetch("/api/profile/change_password/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token "+o.token,"X-CSRFToken":r||""},body:JSON.stringify(b.value)})).json();i.success==="true"?(m.value="Password changed successfully!",b.value={old_password:"",new_password:"",new_password_confirm:""},T()):c.value=i.error}catch(r){console.error("Error changing password:",r),c.value="An error occurred while changing password."}};return D(()=>{H(),M()}),{userProfile:e,hobbiesList:v,editProfile:a,newHobby:g,showNewHobbyForm:P,passwordForm:b,showPasswordModal:l,errorMessage:n,modalErrorMessage:c,successMessage:m,updateProfile:U,addNewHobbyOption:V,addNewHobby:F,showChangePasswordModal:E,closeChangePasswordModal:T,changePassword:S}}}),J={class:"container mt-5"},R={class:"profile-section mb-4"},X={key:0},G=["src"],I={key:0,class:"mt-3"},Y={class:"change-password-section"},q={key:0,class:"modal",tabindex:"-1",role:"dialog",style:{display:"block"}},K={class:"modal-dialog",role:"document"},Q={class:"modal-body"},W={key:0,class:"alert alert-danger"},Z={class:"modal-footer"},_={key:1,class:"alert alert-danger"},x={key:2,class:"alert alert-success"};function ee(o,e,v,a,g,P){const b=B("Multiselect");return w(),f("div",J,[e[29]||(e[29]=s("h1",null,"User Dashboard",-1)),s("div",R,[e[23]||(e[23]=s("h3",null,"Your Profile",-1)),o.userProfile?(w(),f("div",X,[s("img",{src:o.userProfile.profile_image,alt:"Profile Picture",class:"profile-image mb-3"},null,8,G),s("div",null,[e[15]||(e[15]=s("label",null,"First Name:",-1)),u(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>o.editProfile.first_name=l),class:"form-control mb-2"},null,512),[[p,o.editProfile.first_name]])]),s("div",null,[e[16]||(e[16]=s("label",null,"Last Name:",-1)),u(s("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=l=>o.editProfile.last_name=l),class:"form-control mb-2"},null,512),[[p,o.editProfile.last_name]])]),s("div",null,[e[17]||(e[17]=s("label",null,"Email:",-1)),u(s("input",{type:"email","onUpdate:modelValue":e[2]||(e[2]=l=>o.editProfile.email=l),class:"form-control mb-2"},null,512),[[p,o.editProfile.email]])]),s("div",null,[e[18]||(e[18]=s("label",null,"Date of Birth:",-1)),u(s("input",{type:"date","onUpdate:modelValue":e[3]||(e[3]=l=>o.editProfile.date_of_birth=l),class:"form-control mb-2"},null,512),[[p,o.editProfile.date_of_birth]])]),s("div",null,[e[21]||(e[21]=s("label",null,"Hobbies:",-1)),z(b,{modelValue:o.editProfile.selectedHobbies,"onUpdate:modelValue":e[4]||(e[4]=l=>o.editProfile.selectedHobbies=l),options:o.hobbiesList,multiple:!0,searchable:!0,taggable:!0,label:"name","track-by":"id",placeholder:"Select or add hobbies",onTag:o.addNewHobbyOption},null,8,["modelValue","options","onTag"]),o.showNewHobbyForm?(w(),f("div",I,[e[19]||(e[19]=s("label",null,"New Hobby Name:",-1)),u(s("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=l=>o.newHobby.name=l),placeholder:"Enter hobby name",class:"form-control mb-2"},null,512),[[p,o.newHobby.name]]),e[20]||(e[20]=s("label",null,"New Hobby Description:",-1)),u(s("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=l=>o.newHobby.description=l),placeholder:"Enter hobby description",class:"form-control mb-2"},null,512),[[p,o.newHobby.description]]),s("button",{onClick:e[7]||(e[7]=(...l)=>o.addNewHobby&&o.addNewHobby(...l)),class:"btn btn-primary"}," Add Hobby ")])):y("",!0)]),e[22]||(e[22]=s("br",null,null,-1)),s("button",{onClick:e[8]||(e[8]=(...l)=>o.updateProfile&&o.updateProfile(...l)),class:"btn btn-primary"}," Save Profile ")])):y("",!0)]),s("div",Y,[e[24]||(e[24]=s("h3",null,"Change Password",-1)),s("button",{class:"btn btn-danger",onClick:e[9]||(e[9]=l=>o.showPasswordModal=!0)}," Change Password ")]),o.showPasswordModal?(w(),f("div",q,[s("div",K,[e[28]||(e[28]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title"},"Update Password")],-1)),s("div",Q,[s("div",null,[e[25]||(e[25]=s("label",null,"Old Password:",-1)),u(s("input",{type:"password","onUpdate:modelValue":e[10]||(e[10]=l=>o.passwordForm.old_password=l),class:"form-control mb-2"},null,512),[[p,o.passwordForm.old_password]])]),s("div",null,[e[26]||(e[26]=s("label",null,"New Password:",-1)),u(s("input",{type:"password","onUpdate:modelValue":e[11]||(e[11]=l=>o.passwordForm.new_password=l),class:"form-control mb-2"},null,512),[[p,o.passwordForm.new_password]])]),s("div",null,[e[27]||(e[27]=s("label",null,"Confirm New Password:",-1)),u(s("input",{type:"password","onUpdate:modelValue":e[12]||(e[12]=l=>o.passwordForm.new_password_confirm=l),class:"form-control mb-2"},null,512),[[p,o.passwordForm.new_password_confirm]])])]),o.modalErrorMessage?(w(),f("div",W,k(o.modalErrorMessage),1)):y("",!0),s("div",Z,[s("button",{type:"button",class:"btn btn-warning",onClick:e[13]||(e[13]=(...l)=>o.changePassword&&o.changePassword(...l))}," Update Password "),s("button",{type:"button",class:"btn btn-secondary",onClick:e[14]||(e[14]=(...l)=>o.closeChangePasswordModal&&o.closeChangePasswordModal(...l))}," Close ")])])])):y("",!0),e[30]||(e[30]=s("br",null,null,-1)),o.errorMessage?(w(),f("div",_,k(o.errorMessage),1)):y("",!0),o.successMessage?(w(),f("div",x,k(o.successMessage),1)):y("",!0)])}const re=$(L,[["render",ee],["__scopeId","data-v-63e7dfad"]]);export{re as default};
