import{s as S}from"./vue-multiselect.min-DyJL9AHb.js";import{d as E,r as a,g as k,u as I,a as U,_ as V,c as m,b as o,w as i,v as d,h as N,e as g,t as y,f as C,i as M,o as p}from"./index-f_9B7w0P.js";function q(){const s=document.querySelector('meta[name="csrf-token"]');return s?s.getAttribute("content"):null}const P=E({components:{Multiselect:S},setup(){const s=a({first_name:"",last_name:"",email:"",date_of_birth:"",password:"",confirm_password:""}),e=a([]),v=a([]),f=a(!1),b=a(!1),l=a(null),u=a(null),r=async()=>{try{const t=await(await fetch("/api/hobbies/")).json();v.value=t.result}catch(n){console.error("Failed to fetch hobbies:",n)}};return k(()=>{console.log("Fetching hobbies..."),r()}),{form:s,selectedHobbies:e,hobbyOptions:v,passwordError:f,userExistsError:b,errorMessage:l,successMessage:u,submit:async()=>{if(f.value=!1,b.value=!1,l.value=null,u.value=null,s.value.password!==s.value.confirm_password){f.value=!0;return}const n={first_name:s.value.first_name,last_name:s.value.last_name,email:s.value.email,date_of_birth:s.value.date_of_birth,password:s.value.password,password1:s.value.password,password2:s.value.confirm_password,hobbies:e.value.map(t=>({id:t.id,name:t.name}))};try{const t=q(),w=await(await fetch("/api/register/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":t||""},body:JSON.stringify(n)})).json();if(w.success==="true"){const h={method:"POST",headers:{"Content-type":"application/json","X-CSRFToken":t||""},body:JSON.stringify({username:n.email,password:n.password})},c=await(await fetch("/api/login/",h)).json();c.success==="true"?(I().login(c.result.user,c.result.access_token),U.push("/dashboard"),u.value="Signup and login successful!"):l.value="Signup successful, but login failed. Error: "+c.error}else w.error==="User already exists"?b.value=!0:l.value="Signup failed: "+w.error}catch(t){console.error("Error during signup:",t),l.value="An error occurred during signup. Please try again."}}}}}),T={class:"container mt-5"},O={class:"mb-3"},j={class:"mb-3"},B={class:"mb-3"},F={class:"mb-3"},H={class:"mb-3"},D={class:"mb-3"},_={class:"mb-3"},$={key:0,class:"alert alert-danger"},A={key:1,class:"alert alert-danger"},J={key:2,class:"alert alert-danger"},R={key:3,class:"alert alert-success"};function X(s,e,v,f,b,l){const u=M("multiselect");return p(),m("div",T,[o("form",{onSubmit:e[7]||(e[7]=C((...r)=>s.submit&&s.submit(...r),["prevent"])),class:"border p-4 bg-light"},[e[15]||(e[15]=o("h2",{class:"mb-4 text-center"},"Sign Up",-1)),o("div",O,[e[8]||(e[8]=o("label",{for:"firstNameInput",class:"form-label"},"First Name",-1)),i(o("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=r=>s.form.first_name=r),class:"form-control",id:"firstNameInput",placeholder:"Enter first name",required:""},null,512),[[d,s.form.first_name]])]),o("div",j,[e[9]||(e[9]=o("label",{for:"lastNameInput",class:"form-label"},"Last Name",-1)),i(o("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=r=>s.form.last_name=r),class:"form-control",id:"lastNameInput",placeholder:"Enter last name",required:""},null,512),[[d,s.form.last_name]])]),o("div",B,[e[10]||(e[10]=o("label",{for:"emailInput",class:"form-label"},"Email",-1)),i(o("input",{type:"email","onUpdate:modelValue":e[2]||(e[2]=r=>s.form.email=r),class:"form-control",id:"emailInput",placeholder:"Enter email",required:""},null,512),[[d,s.form.email]])]),o("div",F,[e[11]||(e[11]=o("label",{for:"dobInput",class:"form-label"},"Date of Birth",-1)),i(o("input",{type:"date","onUpdate:modelValue":e[3]||(e[3]=r=>s.form.date_of_birth=r),class:"form-control",id:"dobInput",placeholder:"Enter date of birth",required:""},null,512),[[d,s.form.date_of_birth]])]),o("div",H,[e[12]||(e[12]=o("label",{for:"hobbiesInput",class:"form-label"},"Hobbies",-1)),N(u,{modelValue:s.selectedHobbies,"onUpdate:modelValue":e[4]||(e[4]=r=>s.selectedHobbies=r),options:s.hobbyOptions,label:"name","track-by":"id",multiple:""},null,8,["modelValue","options"])]),o("div",D,[e[13]||(e[13]=o("label",{for:"passwordInput",class:"form-label"},"Password",-1)),i(o("input",{type:"password","onUpdate:modelValue":e[5]||(e[5]=r=>s.form.password=r),class:"form-control",id:"passwordInput",placeholder:"Password",required:""},null,512),[[d,s.form.password]])]),o("div",_,[e[14]||(e[14]=o("label",{for:"passwordInput2",class:"form-label"},"Confirm Password",-1)),i(o("input",{type:"password","onUpdate:modelValue":e[6]||(e[6]=r=>s.form.confirm_password=r),class:"form-control",id:"passwordInput2",placeholder:"Confirm Password",required:""},null,512),[[d,s.form.confirm_password]])]),s.passwordError?(p(),m("div",$," Passwords do not match. ")):g("",!0),s.userExistsError?(p(),m("div",A," User already exists. ")):g("",!0),s.errorMessage?(p(),m("div",J,y(s.errorMessage),1)):g("",!0),s.successMessage?(p(),m("div",R,y(s.successMessage),1)):g("",!0),e[16]||(e[16]=o("button",{type:"submit",class:"btn btn-primary"},"Sign Up",-1))],32)])}const Y=V(P,[["render",X]]);export{Y as default};
