import{s as k}from"./vue-multiselect.min-CHG4CS3T.js";import{d as T,u as N,f as d,g as V,_ as U,c as w,a as s,w as r,v as i,h as F,b as v,i as S,o as y}from"./index-Ct5SDsbx.js";function E(){const o=document.querySelector('meta[name="csrf-token"]');return o?o.getAttribute("content"):null}const j=T({components:{Multiselect:k},setup(){const o=N(),e=d(null),b=d([]),n=d({first_name:"",last_name:"",email:"",date_of_birth:"",selectedHobbies:[]}),p=d({name:"",description:""}),m=d(!1),f=d({old_password:"",new_password:"",new_password_confirm:""}),l=d(!1),P=async()=>{try{const a=await(await fetch("/api/my_profile",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token "+o.token}})).json();e.value=a.result,e.value&&(n.value={first_name:e.value.first_name,last_name:e.value.last_name,email:e.value.email,date_of_birth:e.value.date_of_birth,selectedHobbies:e.value.hobbies.map(u=>u)}),g()}catch(t){console.error("Error loading profile:",t)}},g=async()=>{try{const a=await(await fetch("/api/hobbies/",{method:"GET",headers:{"Content-Type":"application/json"}})).json();b.value=a.result}catch(t){console.error("Error loading hobbies list:",t)}},h=async()=>{try{const a=n.value.selectedHobbies.filter(u=>u&&u.id!=="add_new").map(u=>u.id);await fetch("/api/profile/update/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Token "+o.token},body:JSON.stringify({first_name:n.value.first_name,last_name:n.value.last_name,email:n.value.email,date_of_birth:n.value.date_of_birth,hobbies:a})}),alert("Profile updated successfully!"),P()}catch(t){console.error("Error updating profile:",t)}},H=t=>{p.value.name=t,m.value=!0},C=async()=>{try{const a=await(await fetch("/api/hobbies/add/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Token "+o.token},body:JSON.stringify(p.value)})).json();b.value.push(a.result),n.value.selectedHobbies.push(a.result),p.value={name:"",description:""},m.value=!1}catch(t){console.error("Failed to add new hobby:",t)}},c=async()=>{try{const t=E();(await fetch("/api/profile/change_password/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token "+o.token,"X-CSRFToken":t||""},body:JSON.stringify(f.value)})).status===200?(alert("Password changed successfully!"),l.value=!1):alert("Failed to change password. Please try again.")}catch(t){console.error("Error changing password:",t)}};return V(()=>{P()}),{userProfile:e,hobbiesList:b,editProfile:n,newHobby:p,showNewHobbyForm:m,passwordForm:f,showChangePassword:l,updateProfile:h,addNewHobbyOption:H,addNewHobby:C,changePassword:c}}}),O={class:"container mt-5"},A={class:"profile-section mb-4"},$={key:0},D=["src"],M={key:0,class:"mt-3"},z={class:"change-password-section"},B={key:0,class:"modal-overlay"},L={class:"modal-content"};function J(o,e,b,n,p,m){const f=S("Multiselect");return y(),w("div",O,[e[28]||(e[28]=s("h1",null,"User Dashboard",-1)),s("div",A,[e[22]||(e[22]=s("h3",null,"Your Profile",-1)),o.userProfile?(y(),w("div",$,[s("img",{src:o.userProfile.profile_image,alt:"Profile Picture",class:"profile-image mb-3"},null,8,D),s("div",null,[e[15]||(e[15]=s("label",null,"First Name:",-1)),r(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>o.editProfile.first_name=l),class:"form-control mb-2"},null,512),[[i,o.editProfile.first_name]])]),s("div",null,[e[16]||(e[16]=s("label",null,"Last Name:",-1)),r(s("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=l=>o.editProfile.last_name=l),class:"form-control mb-2"},null,512),[[i,o.editProfile.last_name]])]),s("div",null,[e[17]||(e[17]=s("label",null,"Email:",-1)),r(s("input",{type:"email","onUpdate:modelValue":e[2]||(e[2]=l=>o.editProfile.email=l),class:"form-control mb-2"},null,512),[[i,o.editProfile.email]])]),s("div",null,[e[18]||(e[18]=s("label",null,"Date of Birth:",-1)),r(s("input",{type:"date","onUpdate:modelValue":e[3]||(e[3]=l=>o.editProfile.date_of_birth=l),class:"form-control mb-2"},null,512),[[i,o.editProfile.date_of_birth]])]),s("div",null,[e[21]||(e[21]=s("label",null,"Hobbies:",-1)),F(f,{modelValue:o.editProfile.selectedHobbies,"onUpdate:modelValue":e[4]||(e[4]=l=>o.editProfile.selectedHobbies=l),options:o.hobbiesList,multiple:!0,searchable:!0,taggable:!0,label:"name","track-by":"id",placeholder:"Select or add hobbies",onTag:o.addNewHobbyOption},null,8,["modelValue","options","onTag"]),o.showNewHobbyForm?(y(),w("div",M,[e[19]||(e[19]=s("label",null,"New Hobby Name:",-1)),r(s("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=l=>o.newHobby.name=l),placeholder:"Enter hobby name",class:"form-control mb-2"},null,512),[[i,o.newHobby.name]]),e[20]||(e[20]=s("label",null,"Description:",-1)),r(s("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>o.newHobby.description=l),placeholder:"Enter hobby description",class:"form-control mb-2"},null,512),[[i,o.newHobby.description]]),s("button",{class:"btn btn-primary",onClick:e[7]||(e[7]=(...l)=>o.addNewHobby&&o.addNewHobby(...l))},"Add Hobby")])):v("",!0)]),s("button",{class:"btn btn-primary",onClick:e[8]||(e[8]=(...l)=>o.updateProfile&&o.updateProfile(...l))},"Save Profile")])):v("",!0)]),s("div",z,[e[23]||(e[23]=s("h3",null,"Change Password",-1)),s("button",{class:"btn btn-warning",onClick:e[9]||(e[9]=l=>o.showChangePassword=!0)},"Change Password")]),o.showChangePassword?(y(),w("div",B,[s("div",L,[e[27]||(e[27]=s("h3",null,"Change Password",-1)),s("div",null,[e[24]||(e[24]=s("label",null,"Old Password:",-1)),r(s("input",{type:"password","onUpdate:modelValue":e[10]||(e[10]=l=>o.passwordForm.old_password=l),class:"form-control mb-2"},null,512),[[i,o.passwordForm.old_password]])]),s("div",null,[e[25]||(e[25]=s("label",null,"New Password:",-1)),r(s("input",{type:"password","onUpdate:modelValue":e[11]||(e[11]=l=>o.passwordForm.new_password=l),class:"form-control mb-2"},null,512),[[i,o.passwordForm.new_password]])]),s("div",null,[e[26]||(e[26]=s("label",null,"Confirm New Password:",-1)),r(s("input",{type:"password","onUpdate:modelValue":e[12]||(e[12]=l=>o.passwordForm.new_password_confirm=l),class:"form-control mb-2"},null,512),[[i,o.passwordForm.new_password_confirm]])]),s("button",{class:"btn btn-primary",onClick:e[13]||(e[13]=(...l)=>o.changePassword&&o.changePassword(...l))},"Submit"),s("button",{class:"btn btn-secondary",onClick:e[14]||(e[14]=l=>o.showChangePassword=!1)},"Close")])])):v("",!0)])}const q=U(j,[["render",J],["__scopeId","data-v-605ee471"]]);export{q as default};
